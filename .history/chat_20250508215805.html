<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHAT - THE UNDERWEB</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="common.js"></script>
    <style>
        /* Base Styles and Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-bg: #0a0a14;
            --secondary-bg: #141428;
            --tertiary-bg: #1a1a2e;
            --primary-text: #c8c8ff;
            --secondary-text: #8080ff;
            --accent-color: #4f4fff;
            --accent-glow: #4f4fff80;
            --border-color: #3333aa;
            --box-shadow: 0 0 15px #2222aa;
            --terminal-green: #00ff66;
        }

        @font-face {
            font-family: 'VT323';
            src: url('https://fonts.gstatic.com/s/vt323/v17/pxiKyp0ihIEF2isQFJXUdVNF.woff2') format('woff2');
            font-display: swap;
        }

        body {
            font-family: 'VT323', monospace;
            background-color: var(--primary-bg);
            color: var(--primary-text);
            background-image:
                radial-gradient(circle at 25% 25%, #1a1a5060 2%, transparent 10%),
                radial-gradient(circle at 75% 75%, #1a1a5060 2%, transparent 10%),
                linear-gradient(45deg, #0a0a1480 25%, transparent 25%, transparent 75%, #0a0a1480 75%);
            background-size: 100px 100px, 100px 100px, 100px 100px;
            background-attachment: fixed;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Animation Keyframes */
        @keyframes pulse {
            0% { opacity: 0.7; text-shadow: 0 0 5px var(--accent-glow); }
            50% { opacity: 1; text-shadow: 0 0 15px var(--accent-glow), 0 0 30px var(--accent-glow); }
            100% { opacity: 0.7; text-shadow: 0 0 5px var(--accent-glow); }
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-5px, 5px); filter: hue-rotate(90deg); }
            40% { transform: translate(-5px, -5px); filter: hue-rotate(180deg); }
            60% { transform: translate(5px, 5px); filter: hue-rotate(270deg); }
            80% { transform: translate(5px, -5px); filter: hue-rotate(360deg); }
            100% { transform: translate(0); }
        }

        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }

        @keyframes fadeInOut {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }

        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }

        /* Header Styles */
        header {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 1rem;
            position: relative;
            overflow: hidden;
            background-color: rgba(10, 10, 20, 0.8);
            border-bottom: 2px solid var(--border-color);
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent-color), transparent);
            animation: scanline 8s linear infinite;
            z-index: 1;
        }

        .ascii-art {
            font-size: 0.5rem;
            line-height: 0.6rem;
            white-space: pre;
            text-align: center;
            color: var(--accent-color);
            text-shadow: 0 0 10px var(--accent-glow);
            animation: pulse 4s infinite;
            margin-bottom: 1rem;
            max-width: 100%;
            overflow-x: auto;
            display: none;
        }

        @media (min-width: 768px) {
            .ascii-art {
                font-size: 0.6rem;
                display: block;
            }
        }

        @media (min-width: 1200px) {
            .ascii-art {
                font-size: 0.8rem;
            }
        }

        /* Navigation Styles */
        nav {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            padding: 1rem;
            gap: 1rem;
            background-color: rgba(20, 20, 40, 0.7);
            border-bottom: 1px solid var(--border-color);
        }

        nav a {
            color: var(--secondary-text);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            background-color: rgba(26, 26, 46, 0.8);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        nav a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(79, 79, 255, 0.2), transparent);
            transition: all 0.5s ease;
        }

        nav a:hover {
            color: var(--primary-text);
            background-color: rgba(40, 40, 70, 0.9);
            box-shadow: 0 0 10px var(--accent-glow);
            transform: translateY(-2px);
        }

        nav a:hover::before {
            left: 100%;
        }

        /* Marquee Styles */
        marquee {
            margin: 1rem 0;
            padding: 0.5rem;
            background-color: rgba(10, 10, 20, 0.7);
            color: var(--terminal-green);
            font-weight: bold;
            border-top: 1px dashed var(--border-color);
            border-bottom: 1px dashed var(--border-color);
        }

        .blink {
            animation: fadeInOut 1s infinite;
            color: var(--accent-color);
        }

        /* Main Content Styles */
        main {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        @media (min-width: 992px) {
            main {
                flex-direction: row;
                align-items: flex-start;
            }
        }

        .win98-box {
            background-color: rgba(20, 20, 40, 0.8);
            border: 1px solid var(--border-color);
            box-shadow: var(--box-shadow);
            margin-bottom: 1rem;
            -webkit-backdrop-filter: blur(5px);
            backdrop-filter: blur(5px);
            max-width: 100%;
            position: relative;
            overflow: hidden;
        }

        .win98-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                linear-gradient(45deg, transparent 65%, rgba(79, 79, 255, 0.1) 75%, transparent 85%),
                linear-gradient(135deg, transparent 65%, rgba(79, 79, 255, 0.1) 75%, transparent 85%);
            background-size: 100px 100px;
            animation: float 10s infinite;
            pointer-events: none;
        }

        .win98-box-title {
            background: linear-gradient(90deg, var(--accent-color), var(--tertiary-bg));
            color: #ffffff;
            padding: 0.3rem 0.6rem;
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            border-bottom: 1px solid var(--border-color);
        }

        .win98-box-content {
            padding: 1rem;
        }

        /* Chat Page Specific Styles */
        .chat-container {
            flex: 3;
            display: flex;
            flex-direction: column;
            height: calc(100vh - 300px);
            min-height: 500px;
        }

        .sidebar {
            flex: 1;
            position: sticky;
            top: 1rem;
        }

        @media (max-width: 991px) {
            .sidebar {
                position: static;
            }
        }

        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-height: calc(100vh - 450px);
            min-height: 300px;
        }

        .chat-input-container {
            padding: 1rem;
            border-top: 1px solid var(--border-color);
            background-color: rgba(15, 15, 30, 0.8);
        }

        .chat-input-form {
            display: flex;
            gap: 0.5rem;
        }

        .chat-input {
            flex-grow: 1;
            padding: 0.5rem;
            background-color: rgba(10, 10, 20, 0.8);
            color: var(--primary-text);
            border: 1px solid var(--border-color);
            font-family: 'VT323', monospace;
        }

        .chat-submit {
            padding: 0.5rem 1rem;
            background-color: var(--tertiary-bg);
            color: var(--primary-text);
            border: 1px solid var(--border-color);
            cursor: pointer;
            font-family: 'VT323', monospace;
            transition: all 0.3s ease;
        }

        .chat-submit:hover {
            background-color: var(--accent-color);
            box-shadow: 0 0 10px var(--accent-glow);
        }

        .message {
            padding: 0.8rem;
            border-radius: 1rem;
            max-width: 80%;
            position: relative;
            animation: fadeIn 0.5s ease;
        }

        .message.sent {
            align-self: flex-end;
            background-color: rgba(40, 40, 70, 0.8);
            border-bottom-right-radius: 0;
            border-left: 2px solid var(--accent-color);
        }

        .message.received {
            align-self: flex-start;
            background-color: rgba(25, 25, 45, 0.8);
            border-bottom-left-radius: 0;
            border-right: 2px solid var(--accent-color);
        }

        .message.system {
            align-self: center;
            background-color: rgba(20, 20, 40, 0.5);
            color: var(--terminal-green);
            border: 1px dashed var(--border-color);
            text-align: center;
            font-style: italic;
            max-width: 90%;
        }

        .message-content {
            word-break: break-word;
        }

        .message-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--secondary-text);
            margin-top: 0.5rem;
        }

        .avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .message-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .username {
            font-weight: bold;
            color: var(--accent-color);
        }

        /* Users List */
        .users-list {
            list-style: none;
        }

        .user-item {
            display: flex;
            align-items: center;
            padding: 0.5rem;
            border-bottom: 1px solid rgba(79, 79, 255, 0.2);
            transition: all 0.3s ease;
        }

        .user-item:hover {
            background-color: rgba(79, 79, 255, 0.1);
        }

        .user-status {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .status-online {
            background-color: var(--terminal-green);
            box-shadow: 0 0 5px var(--terminal-green);
        }

        .status-idle {
            background-color: #ffaa00;
            box-shadow: 0 0 5px #ffaa00;
        }

        .status-offline {
            background-color: #ff4444;
            box-shadow: 0 0 5px #ff4444;
        }

        /* Channels List */
        .channels-list {
            list-style: none;
        }

        .channel-item {
            padding: 0.5rem;
            border-bottom: 1px solid rgba(79, 79, 255, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        .channel-item:hover {
            background-color: rgba(79, 79, 255, 0.1);
        }

        .channel-item.active {
            background-color: rgba(79, 79, 255, 0.2);
            border-left: 3px solid var(--accent-color);
        }

        .channel-icon {
            margin-right: 0.5rem;
            color: var(--accent-color);
        }

        /* Help Panel */
        .help-panel {
            background-color: rgba(15, 15, 30, 0.9);
            padding: 1rem;
            margin-top: 1rem;
            border-left: 3px solid var(--terminal-green);
        }

        .help-title {
            color: var(--terminal-green);
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }

        .help-item {
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .command {
            color: var(--accent-color);
            font-family: 'Courier New', monospace;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 2rem;
            border-top: 1px solid var(--border-color);
            background-color: rgba(10, 10, 20, 0.8);
            position: relative;
            overflow: hidden;
        }

        footer::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent-color), transparent);
            z-index: 1;
        }

        /* Terminal effect overlay */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.1),
                rgba(0, 0, 0, 0.1) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 1000;
            opacity: 0.3;
        }

        /* Dynamic scanline effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background-color: rgba(120, 120, 255, 0.1);
            box-shadow: 0 0 10px rgba(120, 120, 255, 0.2);
            z-index: 1001;
            animation: scanline 8s linear infinite;
            pointer-events: none;
        }

        /* Stars background effect */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background-color: var(--primary-text);
            border-radius: 50%;
            animation: pulse 3s infinite;
        }

        /* Links and Text */
        a {
            color: var(--secondary-text);
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
        }

        a:hover {
            color: var(--primary-text);
            text-shadow: 0 0 5px var(--accent-glow);
        }

        a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 1px;
            background-color: var(--accent-color);
            transition: width 0.3s ease;
        }

        a:hover::after {
            width: 100%;
        }

        /* Emotes panel */
        .emotes-panel {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
            background-color: rgba(15, 15, 30, 0.8);
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            display: none;
        }

        .emote {
            cursor: pointer;
            text-align: center;
            padding: 0.3rem;
            border-radius: 0.3rem;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }

        .emote:hover {
            background-color: rgba(79, 79, 255, 0.2);
            transform: scale(1.1);
        }

        .toggle-emotes {
            background: none;
            border: none;
            color: var(--secondary-text);
            cursor: pointer;
            padding: 0.3rem;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .toggle-emotes:hover {
            color: var(--primary-text);
            text-shadow: 0 0 5px var(--accent-glow);
        }
    </style>
</head>
<body>
    <!-- Stars background effect -->
    <div class="stars" id="stars"></div>

    <header>
        <div class="ascii-art">
            ████████╗██╗  ██╗███████╗    ██╗   ██╗███╗   ██╗██████╗ ███████╗██████╗ ██╗    ██╗███████╗██████╗
            ╚══██╔══╝██║  ██║██╔════╝    ██║   ██║████╗  ██║██╔══██╗██╔════╝██╔══██╗██║    ██║██╔════╝██╔══██╗
               ██║   ███████║█████╗      ██║   ██║██╔██╗ ██║██║  ██║█████╗  ██████╔╝██║ █╗ ██║█████╗  ██████╔╝
               ██║   ██╔══██║██╔══╝      ██║   ██║██║╚██╗██║██║  ██║██╔══╝  ██╔══██╗██║███╗██║██╔══╝  ██╔══██╗
               ██║   ██║  ██║███████╗    ╚██████╔╝██║ ╚████║██████╔╝███████╗██║  ██║╚███╔███╔╝███████╗██████╔╝
               ╚═╝   ╚═╝  ╚═╝╚══════╝     ╚═════╝ ╚═╝  ╚═══╝╚═════╝ ╚══════╝╚═╝  ╚═╝ ╚══╝╚══╝ ╚══════╝╚═════╝
        </div>
        <div class="win98-box responsive-container">
            <div class="win98-box-title">
                <span>chat.gif</span>
                <span>X</span>
            </div>
            <div class="win98-box-content">
                <img src="https://via.placeholder.com/600x150?text=THE+UNDERWEB+CHAT" alt="THE UNDERWEB Chat Banner" class="banner-image">
            </div>
        </div>
    </header>

    <nav>
        <a href="/">HOME</a>
        <a href="linksindex.html">INDEX</a>
        <a href="links.html">LINKS</a>
        <a href="about.html">ABOUT</a>
        <a href="chat.html">CHAT</a>
    </nav>

    <marquee scrollamount="5" behavior="alternate">
        <span class="blink">★</span> COMMUNE WITH FELLOW DIGITAL DREAMERS - JOIN THE CONVERSATION <span class="blink">★</span>
    </marquee>

    <main>
        <div class="sidebar">
            <div class="win98-box">
                <div class="win98-box-title">
                    <span>Channels</span>
                    <span>X</span>
                </div>
                <div class="win98-box-content">
                    <ul class="channels-list">
                        <li class="channel-item active">
                            <span class="channel-icon">#</span> general
                        </li>
                        <li class="channel-item">
                            <span class="channel-icon">#</span> digital-art
                        </li>
                        <li class="channel-item">
                            <span class="channel-icon">#</span> web-archaeology
                        </li>
                        <li class="channel-item">
                            <span class="channel-icon">#</span> music
                        </li>
                        <li class="channel-item">
                            <span class="channel-icon">#</span> code
                        </li>
                        <li class="channel-item">
                            <span class="channel-icon">#</span> dreaming
                        </li>
                    </ul>
                </div>
            </div>

            <div class="win98-box">
                <div class="win98-box-title">
                    <span>Online Users</span>
                    <span>X</span>
                </div>
                <div class="win98-box-content">
                    <ul class="users-list">
                        <li class="user-item">
                            <div class="user-status status-online"></div>
                            <span>VOID_WALKER</span>
                        </li>
                        <li class="user-item">
                            <div class="user-status status-online"></div>
                            <span>PIXEL_DREAMER</span>
                        </li>
                        <li class="user-item">
                            <div class="user-status status-idle"></div>
                            <span>CODE_POET</span>
                        </li>
                        <li class="user-item">
                            <div class="user-status status-offline"></div>
                            <span>NET_GHOST</span>
                        </li>
                        <li class="user-item">
                            <div class="user-status status-online"></div>
                            <span>GLITCH_ENTITY</span>
                        </li>
                        <li class="user-item">
                            <div class="user-status status-online"></div>
                            <span>CURSOR_DANCER</span>
                        </li>
                        <li class="user-item">
                            <div class="user-status status-idle"></div>
                            <span>ECHO_MEMORY</span>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="win98-box">
                <div class="win98-box-title">
                    <span>Commands</span>
                    <span>X</span>
                </div>
                <div class="win98-box-content">
                    <div class="help-panel">
                        <div class="help-title">Channel Commands</div>
                        <div class="help-item">
                            <span class="command">/join [channel]</span> - Join a channel
                        </div>
                        <div class="help-item">
                            <span class="command">/whisper [user] [message]</span> - Send private message
                        </div>
                        <div class="help-item">
                            <span class="command">/dream [prompt]</span> - Generate a dream image
                        </div>
                        <div class="help-item">
                            <span class="command">/void</span> - Enter the void (silent mode)
                        </div>
                        <div class="help-item">
                            <span class="command">/random</span> - Visit a random website
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="chat-container win98-box">
            <div class="win98-box-title">
                <span># general</span>
                <span>X</span>
            </div>
            <div class="chat-messages" id="chat-messages">
                <div class="message system">
                    <div class="message-content">
                        Welcome to THE UNDERWEB Chat. This is the beginning of the #general channel.
                    </div>
                </div>

                <div class="message received">
                    <div class="message-header">
                        <div class="avatar avatar-blue">V</div>
                        <div class="username">VOID_WALKER</div>
                    </div>
                    <div class="message-content">
                        Has anyone explored that strange subdomain on the old Geocities archive? The one with all the corrupted gifs?
                    </div>
                    <div class="message-meta">
                        <span>14:23</span>
                        <span>today</span>
                    </div>
                </div>

                <div class="message received">
                    <div class="message-header">
                        <div class="avatar avatar-pink">P</div>
                        <div class="username">PIXEL_DREAMER</div>
                    </div>
                    <div class="message-content">
                        I spent hours there last night. Those corrupted images have this haunting beauty to them - like memories dissolving in real time.
                    </div>
                    <div class="message-meta">
                        <span>14:25</span>
                        <span>today</span>
                    </div>
                </div>

                <div class="message system">
                    <div class="message-content">
                        USER_456 has entered the chat.
                    </div>
                </div>

                <div class="message received">
                    <div class="message-header">
                        <div class="avatar avatar-green">C</div>
                        <div class="username">CODE_POET</div>
                    </div>
                    <div class="message-content">
                        I've been working on a tool to extract the corrupted data and transform it into music. The results are... unsettling but fascinating.
                    </div>
                    <div class="message-meta">
                        <span>14:30</span>
                        <span>today</span>
                    </div>
                </div>

                <div class="message sent">
                    <div class="message-content">
                        That sounds amazing! Would love to hear the audio sometime. I've been collecting old web animations myself.
                    </div>
                    <div class="message-meta">
                        <span>14:32</span>
                        <span>today</span>
                    </div>
                </div>

                <div class="message received">
                    <div class="message-header">
                        <div class="avatar avatar-blue">V</div>
                        <div class="username">VOID_WALKER</div>
                    </div>
                    <div class="message-content">
                        I'll be hosting another deep web exploration session tomorrow at midnight. Join if you're interested in discovering some truly forgotten corners of the internet.
                    </div>
                    <div class="message-meta">
                        <span>14:35</span>
                        <span>today</span>
                    </div>
                </div>

                <div class="message system">
                    <div class="message-content">
                        GLITCH_ENTITY is now dreaming...
                    </div>
                </div>
            </div>

            <div class="chat-input-container">
                <form class="chat-input-form" id="chat-form">
                    <input type="text" class="chat-input" id="chat-input" placeholder="Type your message...">
                    <button type="button" class="toggle-emotes" id="toggle-emotes">[+]</button>
                    <button type="submit" class="chat-submit">Send</button>
                </form>

                <div class="emotes-panel" id="emotes-panel">
                    <div class="emote">:-)</div>
                    <div class="emote">:-(</div>
                    <div class="emote">:-D</div>
                    <div class="emote">:-O</div>
                    <div class="emote">;-)</div>
                    <div class="emote">:-P</div>
                    <div class="emote">:-|</div>
                    <div class="emote">:-/</div>
                    <div class="emote">>_<</div>
                    <div class="emote">^_^</div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 THE UNDERWEB - <a href="/submit">Submit Image</a> - <a href="linksindex.html">Link Directory</a> - <a href="about.html">About</a> - <a href="chat.html">Chat/Forum</a></p>
    </footer>

    <script>
        // Create the stars background
        document.addEventListener("DOMContentLoaded", function() {
            const starsContainer = document.getElementById('stars');
            const numberOfStars = 100;

            for (let i = 0; i < numberOfStars; i++) {
                const star = document.createElement('div');
                star.classList.add('star');

                // Random properties
                const size = Math.random() * 2 + 1;
                const left = Math.random() * 100;
                const top = Math.random() * 100;
                const delay = Math.random() * 3;

                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${left}%`;
                star.style.top = `${top}%`;
                star.style.animationDelay = `${delay}s`;

                starsContainer.appendChild(star);
            }

            // Chat functionality
            const chatForm = document.getElementById('chat-form');
            const chatInput = document.getElementById('chat-input');
            const chatMessages = document.getElementById('chat-messages');
            const toggleEmotes = document.getElementById('toggle-emotes');
            const emotesPanel = document.getElementById('emotes-panel');
            const emotes = document.querySelectorAll('.emote');

            // Toggle emotes panel
            toggleEmotes.addEventListener('click', function() {
                if (emotesPanel.style.display === 'grid') {
                    emotesPanel.style.display = 'none';
                    toggleEmotes.textContent = '[+]';
                } else {
                    emotesPanel.style.display = 'grid';
                    toggleEmotes.textContent = '[-]';
                }
            });

            // Add emotes to input
            emotes.forEach(emote => {
                emote.addEventListener('click', function() {
                    chatInput.value += ' ' + emote.textContent + ' ';
                    chatInput.focus();
                });
            });

            // Send message
            chatForm.addEventListener('submit', function(event) {
                event.preventDefault();

                if (chatInput.value.trim() === '') return;

                // Create message element
                const messageElement = document.createElement('div');
                messageElement.classList.add('message', 'sent');

                const messageContent = document.createElement('div');
                messageContent.classList.add('message-content');
                messageContent.textContent = chatInput.value;

                const messageMeta = document.createElement('div');
                messageMeta.classList.add('message-meta');

                // Get current time
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');

                const timeSpan = document.createElement('span');
                timeSpan.textContent = `${hours}:${minutes}`;

                const dateSpan = document.createElement('span');
                dateSpan.textContent = 'today';

                messageMeta.appendChild(timeSpan);
                messageMeta.appendChild(dateSpan);

                messageElement.appendChild(messageContent);
                messageElement.appendChild(messageMeta);

                // Add message to chat
                chatMessages.appendChild(messageElement);

                // Clear input
                chatInput.value = '';

                // Scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;

                // Simulate response (for demo)
                setTimeout(function() {
                    // Check if message was a command
                    if (messageContent.textContent.startsWith('/')) {
                        handleCommand(messageContent.textContent);
                    } else {
                        // Random chance to get a response
                        if (Math.random() > 0.5) {
                            addResponse();
                        }
                    }
                }, 1000 + Math.random() * 2000);
            });

            // Handle commands
            function handleCommand(command) {
                const systemMessage = document.createElement('div');
                systemMessage.classList.add('message', 'system');

                const messageContent = document.createElement('div');
                messageContent.classList.add('message-content');

                if (command.startsWith('/join')) {
                    const channel = command.split(' ')[1];
                    if (channel) {
                        messageContent.textContent = `You have joined the #${channel} channel.`;
                        document.querySelector('.win98-box-title span:first-child').textContent = `# ${channel}`;
                    } else {
                        messageContent.textContent = 'Please specify a channel to join.';
                    }
                } else if (command.startsWith('/whisper')) {
                    const parts = command.split(' ');
                    if (parts.length >= 3) {
                        const user = parts[1];
                        messageContent.textContent = `You sent a private message to ${user}.`;
                    } else {
                        messageContent.textContent = 'Please specify a user and message.';
                    }
                } else if (command.startsWith('/dream')) {
                    messageContent.textContent = 'Dream generation initiated. Your dream will materialize shortly...';
                } else if (command === '/void') {
                    messageContent.textContent = 'You have entered the void. Silent mode activated.';
                } else if (command === '/random') {
                    messageContent.textContent = 'Transporting you to a random corner of the web...';
                } else {
                    messageContent.textContent = 'Unknown command. Type /help for a list of available commands.';
                }

                systemMessage.appendChild(messageContent);
                chatMessages.appendChild(systemMessage);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // Add simulated response
            function addResponse() {
                const responses = [
                    "That's fascinating! Have you explored the early internet archive collections?",
                    "I found this weird website last night that seems to be generating endless poetry using old forum posts.",
                    "Does anyone remember those web rings from the late 90s? I'm trying to recreate that experience.",
                    "Just discovered a hidden directory of abandoned net art from 2005. It's like stepping into a digital time capsule.",
                    "Has anyone been experimenting with glitch art generators? I've been creating some interesting textures.",
                    "The boundaries between digital and dream spaces have always been thin."
                ];

                const users = [
                    { name: "VOID_WALKER", color: "#5555ff" },
                    { name: "PIXEL_DREAMER", color: "#ff55ff" },
                    { name: "CODE_POET", color: "#55ff55" },
                    { name: "GLITCH_ENTITY", color: "#ffaa55" },
                    { name: "ECHO_MEMORY", color: "#55ffff" }
                ];

                const randomUser = users[Math.floor(Math.random() * users.length)];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];

                const messageElement = document.createElement('div');
                messageElement.classList.add('message', 'received');

                const messageHeader = document.createElement('div');
                messageHeader.classList.add('message-header');

                const avatar = document.createElement('div');
                avatar.classList.add('avatar');
                avatar.style.backgroundColor = randomUser.color;
                avatar.textContent = randomUser.name.charAt(0);

                const username = document.createElement('div');
                username.classList.add('username');
                username.textContent = randomUser.name;

                messageHeader.appendChild(avatar);
                messageHeader.appendChild(username);

                const messageContent = document.createElement('div');
                messageContent.classList.add('message-content');
                messageContent.textContent = randomResponse;

                const messageMeta = document.createElement('div');
                messageMeta.classList.add('message-meta');

                // Get current time
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');

                const timeSpan = document.createElement('span');
                timeSpan.textContent = `${hours}:${minutes}`;

                const dateSpan = document.createElement('span');
                dateSpan.textContent = 'today';

                messageMeta.appendChild(timeSpan);
                messageMeta.appendChild(dateSpan);

                messageElement.appendChild(messageHeader);
                messageElement.appendChild(messageContent);
                messageElement.appendChild(messageMeta);

                chatMessages.appendChild(messageElement);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // Channel switching
            const channelItems = document.querySelectorAll('.channel-item');

            channelItems.forEach(channel => {
                channel.addEventListener('click', function() {
                    // Remove active class from all channels
                    channelItems.forEach(ch => ch.classList.remove('active'));

                    // Add active class to clicked channel
                    this.classList.add('active');

                    // Update channel title
                    const channelName = this.textContent.trim();
                    document.querySelector('.win98-box-title span:first-child').textContent = `# ${channelName}`;

                    // Add system message
                    const systemMessage = document.createElement('div');
                    systemMessage.classList.add('message', 'system');

                    const messageContent = document.createElement('div');
                    messageContent.classList.add('message-content');
                    messageContent.textContent = `You have joined the #${channelName} channel.`;

                    systemMessage.appendChild(messageContent);

                    // Clear chat messages
                    chatMessages.innerHTML = '';

                    // Add welcome message
                    const welcomeMessage = document.createElement('div');
                    welcomeMessage.classList.add('message', 'system');

                    const welcomeContent = document.createElement('div');
                    welcomeContent.classList.add('message-content');
                    welcomeContent.textContent = `Welcome to THE UNDERWEB Chat. This is the beginning of the #${channelName} channel.`;

                    welcomeMessage.appendChild(welcomeContent);

                    chatMessages.appendChild(welcomeMessage);
                    chatMessages.appendChild(systemMessage);
                });
            });

            // Dreamy floating effect for windows
            const dreamyElements = document.querySelectorAll('.win98-box');

            window.addEventListener('scroll', function() {
                dreamyElements.forEach(element => {
                    const rect = element.getBoundingClientRect();
                    const isInView = rect.top < window.innerHeight && rect.bottom > 0;

                    if (isInView) {
                        const scrollPos = window.scrollY;
                        const offset = (scrollPos - rect.top) * 0.05;
                        element.style.transform = `translateY(${Math.sin(offset) * 5}px)`;
                    }
                });
            });
        });
    </script>
    <script src="chat.js"></script>
</body>
</html>